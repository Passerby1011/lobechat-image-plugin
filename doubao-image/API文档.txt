# 通用2.1-文生图
最近更新时间：2025.04.27 20:53:58
首次发布时间：2024.11.11 15:06:07

## 接口简介
本次升级 (对比通用2.0和通用2.0 PRO），除了结构准确和美感明显提升外，重点支持了中英文字符渲染，推荐在通用类别（不局限于人像人体）使用。

**常用提示词（prompt）模版**：【艺术风格】+【主体描述】+【文字排版】

*   艺术风格：确定画面整体基调，如写实风、插画风，或更具体的风格，如中国水墨风等；
*   画面主体描述：聚焦主画面内容，例如描述海报中的人物正在做某件事，或具体的物品形态与状态等；
*   文字排版描述：将文字内容放在双引号“”内，同时通过指令描述文字的位置、大小、颜色和风格，精准调整排版效果。

可运用模版格式，根据需求灵活调整描述，当暂时没有明确灵感时，可尝试用简短的描述生成初稿，从中提炼创意，再通过迭代优化提示词，逐步实现理想效果。

## 请求说明

[TABLE]
| 名称         | 内容                               |
| ------------ | ---------------------------------- |
| 接口地址     | `https://visual.volcengineapi.com` |
| 请求方式     | POST                               |
| Content-Type | application/json                   |
[/TABLE]

### Header参数
完整公共参数列表见 公共参数
本服务Region为cn-north-1； Service为cv

### Query参数
拼接到url后的参数，示例：`https://visual.volcengineapi.com?Action=CVProcess&Version=2022-08-31`

[TABLE]
| 参数    | 可选/必选 | 类型   | 说明                          |
| ------- | --------- | ------ | ----------------------------- |
| Action  | 必选      | String | 接口名，取固定值：CVProcess   |
| Version | 必选      | String | 版本号，取固定值：2022-08-31 |
[/TABLE]

### Body参数
业务请求参数，放到request.body中，MIME-Type为application/json

[TABLE]
| 参数        | 可选/必选 | 类型   | 说明                                                                                                                                                                | 备注                                                                                                                                                                                                                                                                                                                                                                                                |
| ----------- | --------- | ------ | ------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| req_key     | 必选      | String | 算法名称，取固定值为high_aes_general_v21_L                                                                                                                            |                                                                                                                                                                                                                                                                                                                                                                                                         |
| prompt      | 必选      | String | 用于生成图像的提示词 ，中英文均可输入<br>Prompt 中用引号将希望书写的文字引起来，文字准确率会更高（例如：一张圣诞节海报，上面写着“Merry Christmas”）                                                        |                                                                                                                                                                                                                                                                                                                                                                                                         |
| seed        | 可选      | int    | 随机种子，作为确定扩散初始状态的基础，默认-1（随机）。若随机种子为相同正整数且其他参数均一致，则生成图片极大概率效果一致<br>默认值：-1                                                                                                                  |                                                                                                                                                                                                                                                                                                                                                                                                         |
| scale       | 可选      | float  | 影响文本描述的程度<br>默认值：3.5<br>取值范围：[1, 10]                                                                                                                                      |                                                                                                                                                                                                                                                                                                                                                                                                         |
| ddim_steps  | 可选      | int    | 生成图像的步数，建议使用默认值，过大会造成延迟增加而服务超时<br>默认值：25<br>取值范围：[1, 200]<br>推荐取值范围：[1, 50]                                                                                                        |                                                                                                                                                                                                                                                                                                                                                                                                         |
| width       | 可选      | int    | 生成图像的宽<br>默认值：512<br>取值范围：[256, 768]                                                                                                                                        | 宽、高与512差距过大，则出图效果不佳、延迟过长概率显著增加。<br>超分前建议比例及对应宽高：width*height<br>1:1：512*512<br>4:3：512*384<br>3:4：384*512<br>3:2：512*341<br>2:3：341*512<br>16:9：512*288<br>9:16：288*512 |
| height      | 可选      | int    | 生成图像的高<br>默认值：512<br>取值范围：[256, 768]                                                                                                                                        |                                                                                                                                                                                                                                                                                                                                                                                                         |
| use_pre_llm | 可选      | bool   | 开启文本扩写，会针对输入prompt进行扩写优化，如果输入prompt较短建议开启，如果输入prompt较长建议关闭<br>默认值：true                                                                                                                |                                                                                                                                                                                                                                                                                                                                                                                                         |
| use_sr      | 可选      | bool   | True：文生图+AIGC超分<br>False：文生图<br>默认值：true                                                                                                                                          | 内置的超分功能，开启后可将上述宽高均乘以2返回，此参数打开后延迟会有增加<br>如上述宽高均为512和512，此参数关闭出图 512*512 ，此参数打开出图1024 * 1024                                                                 |
| return_url  | 可选      | bool   | 输出是否返回图片链接 （链接有效期为24小时）                                                                                                                                                 | 如果期望返回永久地址或者二次处理，可以接入：veImageX                                                                                                                                                                                                                                                                                                                        |
| logo_info   | 可选      | LogoInfo | 水印信息                                                                                                                                                                                |                                                                                                                                                                                                                                                                                                                                                                                                         |
[/TABLE]

### LogoInfo
水印相关参数

[TABLE]
| 名称              | 类型    | 必选 | 描述                                                                  | 备注 |
| ----------------- | ------- | ---- | --------------------------------------------------------------------- | ---- |
| add_logo          | Boolean | 否   | 是否添加水印。True为添加，False不添加。默认不添加                               |      |
| position          | Int     | 否   | 水印的位置，取值如下：<br>0-右下角<br>1-左下角<br>2-左上角<br>3-右上角<br>默认0         |      |
| language          | Int     | 否   | 水印的语言，取值如下：<br>0-中文（AI生成）<br>1-英文（Generated by AI）<br>默认0  |      |
| opacity           | Float   | 否   | 水印的不透明度，取值范围0-1，1表示完全不透明，默认0.3                              |      |
| logo_text_content | String  | 否   | 明水印自定义内容                                                            |      |
[/TABLE]

## 输出说明
### 通用输出参数
请参考通用返回字段及错误码

### 业务输出参数
重点关注data 字段，其他字段为公共返回

[TABLE]
| 字段                | 类型            | 说明                                 |
| ------------------- | --------------- | ------------------------------------ |
| binary_data_base64  | array of string | 返回图片的base64数组。               |
| image_urls          | array of string | 输出处理过的图片url<br>数组（单张图） |
[/TABLE]

## 请求&返回完整示例
### 请求示例
```json
{
    "req_key": "high_aes_general_v21_L",
    "prompt": "千军万马",
    "llm_seed": -1,
    "seed": -1,
    "scale": 3.5,
    "ddim_steps": 25,
    "width": 512,
    "height": 512,
    "use_pre_llm": true,
    "use_sr": true,
    "return_url": true,
    "logo_info": {
        "add_logo": false,
        "position": 0,
        "language": 0,
        "opacity": 0.3,
        "logo_text_content": "这里是明水印内容"
    }
}
```

### 输出示例
```json
{
    "code": 10000,
    "data": {
        "algorithm_base_resp": {
            "status_code": 0,
            "status_message": "Success"
        },
        "binary_data_base64": [],
        "image_urls": [
            "https://xxx"
        ],
        "pe_result": "",
        "predict_tags_result": "",
        "rephraser_result": "历史战争风格，千军万马。画面中，众多士兵骑着战马，手持长矛和盾牌，整齐划一地行进在战场上。背景是广阔的战场，尘土飞扬，远处可见战旗飘扬。广角镜头，远景，强烈光影。",
        "request_id": "6c2b84486031b7dcb011a9d1c8ed29e3777f25ca08db1f3e5e4b754df4718ee9"
    },
    "message": "Success",
    "request_id": "2024111114552269F2FA168B2B322E00E8",
    "status": 10000,
    "time_elapsed": "10.887140906s"
}
```

## 错误码
### （1）通用错误码
请参考通用返回字段及错误码

### （2）业务错误码
[TABLE]
| HttpCode | 错误码 | 错误消息               | 描述                             |
| -------- | ------ | ---------------------- | -------------------------------- |
| 200      | 10000  | 无                     | 请求成功                         |
| 400      | 50411  | Pre Img Risk Not Pass  | 输入图片前审核未通过             |
| 400      | 50511  | Post Img Risk Not Pass | 输出图片后审核未通过             |
| 400      | 50412  | Text Risk Not Pass     | 输入文本前审核未通过             |
| 400      | 50512  | Post Text Risk Not Pass| 输出文本后审核未通过             |
| 400      | 50413  | Post Text Risk Not Pass| 输入文本NER、IP、Blocklist等拦截 |
[/TABLE]